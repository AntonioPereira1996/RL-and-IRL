#+TITLE: LSPI sur le GridWorld

Le but de cette expérience, prévue par le [[file:Protocole.org]], est de trouver les paramètres de LSPI.

Le programme suivant montre que LSPI parvient sans encombres à résoudre le MDP du GridWorld. Les paramètres sont :
- $\lambda_{LSTDQ} = 0.1$
- $\gamma = 0.9$
- $\epsilon_{LSPI} = 0.1$
- $T_{LSPI} = 20$
#+begin_src c :tangle LSPI_Exp1.c :main no
#include <gsl/gsl_matrix.h>
#include "phipsi.h"
#include "simulator.h"
#include "utils.h"
#include "LSPI.h"

#include "GridWorld.h"
#include "RL_Globals.h"
#define D_FILE_NAME "Samples.dat"
#define TRANS_WIDTH 7
#define ACTION_FILE "actions.mat"

unsigned int g_iS = 2;
unsigned int g_iA = 1;
unsigned int g_iIt_max_lspi = 20;
gsl_matrix* (*g_fPhi)(gsl_matrix*) = &phi;
gsl_matrix* g_mOmega = NULL;
double g_dLambda_lstdQ = 0.1;
double g_dGamma_lstdq =  0.9;
double g_dEpsilon_lspi = 0.1;
gsl_matrix* g_mActions = NULL; 

int main( void ){
  gsl_matrix* D = file2matrix( D_FILE_NAME, TRANS_WIDTH );
  g_mActions = file2matrix( ACTION_FILE, g_iA );
  gsl_matrix* omega_0 = gsl_matrix_calloc( g_iK, 1 );
  gsl_matrix* omega_expert = lspi( D, omega_0 );
  g_mOmega =  omega_expert;
  gsl_matrix* D_expert = gridworld_simulator( 1000 );
  printf("Longueur moyenne du run de l'expert : %f\n",((double)(D_expert->size1))/1000.);
  return 0;
}

#+end_src

   #+srcname: LSPI_Exp1_make
   #+begin_src makefile
LSPI_Exp1.c: LSPI_Exp1.org
	$(call tangle,"LSPI_Exp1.org")
LSPI_Exp1.o: LSPI_Exp1.c GridWorld.h ../greedy.h ../RL_Globals.h ../utils.h ../LSPI.h ../LSTDQ.h phipsi.h simulator.h
	$(call c2obj,"LSPI_Exp1.c")

LSPI_Exp1.exe: LSPI_Exp1.o ../greedy.o ../utils.o ../LSPI.o ../LSTDQ.o phipsi.o simulator.o
	$(O2EXE) -o LSPI_Exp1.exe LSPI_Exp1.o ../greedy.o ../utils.o ../LSPI.o ../LSTDQ.o phipsi.o simulator.o

LSPI_Exp1: Samples.dat LSPI_Exp1.exe
	./LSPI_Exp1.exe
   #+end_src
  #+srcname: LSPI_Exp1_clean_make
  #+begin_src makefile
LSPI_Exp1_clean:
	find . -maxdepth 1 -iname "LSPI_Exp1.h"   | xargs $(XARGS_OPT) rm
	find . -maxdepth 1 -iname "LSPI_Exp1.c"   | xargs $(XARGS_OPT) rm 
	find . -maxdepth 1 -iname "LSPI_Exp1.o"   | xargs $(XARGS_OPT) rm
	find . -maxdepth 1 -iname "LSPI_Exp1.exe"   | xargs $(XARGS_OPT) rm
	find . -maxdepth 1 -iname "LSPI_Exp1.tex"   | xargs $(XARGS_OPT) rm
	find . -maxdepth 1 -iname "LSPI_Exp1.pdf"   | xargs $(XARGS_OPT) rm
  #+end_src
